# -*- coding: utf-8 -*- 
<% from srjvkk.lib.base import number_format %>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
        "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
    <title>รายการใบเสร็จ</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <style type="text/css">
<!--
.border {
	border: 1px solid #000000;
}
-->
    </style>
</head>
<body style="width:29.7cm; height:21cm;size: landscape;">
	<p align="center"><strong>รายการใบเสร็จ<br>
    โรงพยาบาลจิตเวชขอนแก่นราชนครินทร์ จ.ขอนแก่น<br>
    เครื่องเก็บเงิน ${c.station} จากวันที่ ${c.start_date} ถึงวันที่ ${c.end_date}<br>
	</strong></p>

<table width="100%" border="0" cellspacing="0">
  <tr>
    <td class="border"><div align="center"><strong>ลำดับที่</strong></div></td>
    <td class="border"><div align="center"><strong>นำส่ง</strong></div></td>
    <td class="border"><div align="center"><strong>เลขที่ใบเสร็จ</strong></div></td>
    <td class="border"><div align="center"><strong>วันที่ใบเสร็จ</strong></div></td>
    <td class="border"><div align="center"><strong>hn</strong></div></td>
    <td class="border"><div align="center"><strong>an</strong></div></td>
    <td class="border"><div align="center"><strong>รับเงิน</strong></div></td>
    <td class="border"><div align="center"><strong>เบิกได้</strong></div></td>
    <td class="border"><div align="center"><strong>สงเคราะห์</strong></div></td>
    <td class="border"><div align="center"><strong>ส่วนลด</strong></div></td>
    <td class="border"><div align="center"><strong>ค่ามัดจำ</strong></div></td>
    <td class="border"><div align="center"><strong>ประเภทผู้ป่วย</strong></div></td>
    <td class="border"><div align="center"><strong>ยกเลิก</strong></div></td>
    <td class="border"><div align="center"><strong>วันที่ยกเลิก</strong></div></td>
    <td class="border"><div align="center"><strong>สาเหตุการยกเลิก</strong></div></td>
    <td class="border"><div align="center"><strong>ยกเลิกโดย</strong></div></td>
  </tr>
  % for receipt in c.receipts:
  <tr>
  	<td class="border" style="height:1cm">${receipt['no']}</td>
    <td class="border" style="height:1cm">
    	% if receipt['sent']:
    		<img src="/img/paid.png">
    	% else:
    		<img src="/img/unpaid.png">
    	% endif
    </td>
    <td class="border" style="height:1cm">${receipt['code']}</td>
    <td class="border" style="height:1cm">${receipt['date']}</td>
    <td class="border" style="height:1cm">${receipt['hn']}</td>
    <td class="border" style="height:1cm">${receipt['an']}</td>
    <td class="border" style="height:1cm"><div align="right">${number_format(receipt['receive_amount'], 2)}</div></td>
    <td class="border" style="height:1cm"><div align="right">${number_format(receipt['subsidy_amount'], 2)}</div></td>
    <td class="border" style="height:1cm"><div align="right">${number_format(receipt['support_amount'], 2)}</div></td>
    <td class="border" style="height:1cm"><div align="right">${number_format(receipt['discount'], 2)}</div></td>
    <td class="border" style="height:1cm"><div align="right">${number_format(receipt['deposit'], 2)}</div></td>
    <td class="border" style="height:1cm">${receipt['patient_type']}</td>
    <td class="border" style="height:1cm">
    	% if receipt['cancelled']:
    		<img src="/img/paid.png">
    	% else:
    		<img src="/img/unpaid.png">
    	% endif
    </td>
    <td class="border" style="height:1cm">${receipt['cancelled_date']}</td>
    <td class="border" style="height:1cm">${receipt['cancel_reason']}</td>
    <td class="border" style="height:1cm">${receipt['cancelled_by']}</td>
  </tr>
  % endfor
</table>
<div style="font-size: x-large;">
รวมรับเงิน ${number_format(c.total, 2)} บาท<br>
(${c.total_str})
</div>
<script>
		window.print();
		window.close();
  </script>
</body>
</html>